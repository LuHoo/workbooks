---
title: "Workshop Chapter 2"
author: "Lucas Hoogduin"
date: "`r Sys.Date()`"
output:
  html_document:
    df_print: paged
---

## 2. Probability distributions

### 2.1 Hypergeometric distribution

Density function. The function `dhyper` requires four arguments, `x = k`, `m = M`, `n = N - M`, and `k = n`. In *Case: Number of students*, we sampled $n = 60$ items from a list of $N = 331$ PhDs. We assume that $M = 17$ have erroneously been listed. The probability $P(k = 0)$ of finding no errrors in the sample is calculated as follows.

```{r}
dhyper(x = 0, m = 17, n = 314, k = 60)
```

Similarly, the probability $P(k = 1)$ of finding one error is

```{r}

```

Cumulative probability function. the probability $P(k \leq 1)$ of finding up to one error is

```{r}
phyper(1, 17, 314, 60)
```

This is the sum of the two probabilities $P(k = 0)$ and $P(k = 1)$

```{r}
dhyper(0, 17, 314, 60) + dhyper(1, 17, 314, 60)
```

We can also calculate the right-hand tail probability $P(k > 1)$.

```{r}
phyper(1, 17, 314, 60, lower.tail = FALSE)
```

This is the complement of the left-hand tail probability $P(k \leq 1)$, in other words, the two probabilities sum to one.

```{r}
phyper(1, 17, 314, 60) + phyper(1, 17, 314, 60, lower.tail = FALSE)
```

### 2.2 Binomial distribution

Density function. The function `dbinom` requires three arguments, `x = k`, `size = n`, and `prob = p`. The probabilty `prob` is the error rate in the population, in *Case: Number of students* this is $p = M / N = 17 / 331$.

```{r}
dbinom(x = 1, size = 60, prob = 17 / 331)
```

Cumulative probability function.

```{r}
pbinom(1, 60, 17 / 331)
```

### 2.3 Poisson distribution

Density function. The function `dpois` requires two arguments, `x = k`, and `lambda = np`, with `p` defined as for the binomial distribution.

```{r}
dpois(x = 1, lambda = 60 * 17/ 331)
dpois(3, 60 * 17/ 331)
```

Cumulative probability function.

```{r}
ppois(1, 60 * 17/ 331)
```

### 2.4 Normal distribution

Distribution function. The function `pnorm` requires three arguments, `q` for the sampling result that we evaluate, `mean` for the population mean, and `sd` for the standard deviation of the mean.

```{r}
pnorm(q = 1012, mean = 1030, sd = 115.26/sqrt(200))
```

It is useful for readability to include the argument names in the call of the function, but not strictly necessary. When omitted, the arguments are passed in the order suggested by the help function. Try typing `?pnorm` in your console.

The following commands are therefore equivalent.

```{r}
pnorm(1012, 1030, 115.26 / sqrt(200))
pnorm(q = 1012, mean = 1030, sd = 115.26 / sqrt(200))
pnorm(sd = 115.26/sqrt(200), mean = 1030, q = 1012)
```

### 2.5 Student's $t$ distribution

```{r}
(t_val <- (1004 - 1030) / (73.8 / sqrt(10)))
pt(t_val, 9)
```

Notice that we used another shortcut notation: we added brackets to the assignment of the `t\_val` variable, so that the assigned value is returned immediately.

### 2.6 $\chi^2$ (chi-squared) distribution

The 95\% upper bound on a $\chi^2$ distributed variable with (10 - 1) degrees of freedom is

```{r}
qchisq(p = .95, df = 9)
```

Similarly, to calculate the upper bound for $\sigma^2$, we start with the lower bound of a $\chi^2$ distributed variable

```{r}
qchisq(p = .05, df = 9)
```

### 2.7 $F$ distribution

Hypothesis testing is done with the function `qf`, where we use the argument `lower.tail = FALSE` to indicate the direction of the test.

```{r}
(f_crit <- qf(p = 0.05, df1 = 25, df2 = 23, lower.tail = FALSE))
```

In the example above, the critical value of the $F$ statistic is `r round(f_crit, 6)`. Depending on whether the value of the test statistic is greater or smaller than this value, we then reject the null hypothesis or we do not. 

The probability of obtaining this particular value of the test statistic is calculated with the `pf` function.

```{r}
pf(q = 1.996271, df1 = 25, df2 = 23, lower.tail = FALSE)
```
